## 1. 前言

本节我们一起学习下正则表达式的创建方式,创建正则表达式是我们使用正则对文本匹配、替换和校验的前提。正则表达式在javascript中作为内置对象存在,它的创建方式分为两种。具体的如何创建，就让我们一起展开本章的学习吧！

## 2. 创建一个正则表达式

创建正则表达式的方式有两种,一种是字面量方式创建,另一种是构造函数方式创建,两种方式在书写上有所不同。另外，在es6中构造函数方式创建增加了新的功能，使得正则的创建方式逐渐多样化。

### 2.1 字面量创建

使用字面量方式创建正则我们把只需要匹配的内容用斜杠包裹。当然在包裹之后我们可以在后面加上一些标识来修饰我们匹配的内容。在这一节我们只需要知道后面是可以加上字符即可。比如我在全局匹配汉字糖。

```

var reg=/糖/g;

```

使用这种方式我们可以匹配到一段话里面的所有汉字糖,我们可以看一下测试结果

![1604288049022-wrm](C:\Users\Administrator\Desktop\1604288049022-wrm.png)

### 2.2 构造函数创建

使用构造函数创建正则表达式我们需要使用new运算符来创建正则RegExp对象。这个函数我们可以传两个参数,第一个参数是需要匹配的内容,第二个是标识,这里的两个参数都是字符串类型。我们使用上面同样的例子说明。

```

var reg=new RegExp("糖","g")

```

在这里大家可能会想，我们是否可以用字面量创建的写法和构造函数的写法综合来写呢，答案是可以的。在es5中，RegExp构造函数的参数除了支持上面讲的两个字符串类型以外，还可以只传一个正则表达式参数

```

var reg=new RegExp(/糖/g)

```

到这里还可以给大家推荐一种写法,在es6中,我们可以在只传一个正则表达式参数的基础上,添加第二个参数,参数类型是字符串,也就是之前提到的标识。

```

var reg=new RegExp(/糖/g,"i")

```

此时这个正则表达式等同于

```

var reg=/糖/i

```

我们会发现之前写的g标识被之后的i标识替换了,也就是说如果你想不替换,那么就不需要写第二个参数,如果想要在原来的基础上添加那么建议直接把标识写在第二个参数,避免被替换。

```

var reg=new RegExp(/糖/,"gi")

```

## 3. 创建方式对比

两种创建方式都可以实现正则表达式的创建,但是两种使用起来还是有区别的，我们从性能和写法方面进行对比分析。

### 3.1 性能

字面量方式创建,脚本加载后，正则表达式字面量就会被编译。当正则表达式保持不变时，使用此方法可获得更好的性能。

构造函数方式创建,在脚本运行过程中，用构造函数创建的正则表达式会被编译。如果正则表达式将会改变，或者它将会从用户输入等来源中动态地产生，就需要使用构造函数来创建正则表达式。

### 3.2 写法

#### 3.2.1 字面量创建方式不能进行字符串拼接

字面量中被斜杠包裹的内容是直接识别成字符而不会识别为变量，所以我们如果想使用变量来写，就需要用构造函数方式创建

```

var str1="糖"

var reg1=/str1/  

var reg2=new RegExp(str1+"果")

```

此时我们控制台输入并打印一下reg1和reg2的结果

![1604288350755-byo](C:\Users\Administrator\Desktop\1604288350755-byo.png)

这样我们可以很明显的看出我们定义的汉字糖在字面量的创建中并没有生效,而是直接把变量名作为匹配的字符。所以我们如果定义变量赋值时我们需要使用构造函数的方式创建。

#### 3.2.2 字面量创建时特殊含义的字符不需要转义

我们可以举一个最简单的例子,我们需要匹配数字,在正则中我们用 d 来表示,我们通过两种方式创建的写法有所不同。在用构造函数创建的时候我们需要在原有的基础上加一个反斜杠。这是因为在这里需要解析两次，一次是字符串需要解析特殊字符还有一次是正则需要解析。

```

var reg1=/d/

var reg2=new RegExp("d")

```

## 4. 总结

本节我们学习了正则表达式的创建,这里我们需要注意以下几点:

1. 正则的创建方式有两种:一种是字面量创建,一种是构造函数创建;
2. 字面量创建方式不能进行字符串拼接;
3. 构造函数方式创建时,第一个参数里面的特殊字符需要加上反斜杠;
4. 构造函数方式创建更适用于动态生成正则表达式中，有利于提高性能。

